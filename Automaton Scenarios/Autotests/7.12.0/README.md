# Базовые сценарии обработки отчетов автоматического тестирования

> [!WARNING]
> ВСЕ ПРЕДСТАВЛЕННЫЕ СЦЕНАРИИ ЯВЛЯЮТСЯ ТОЛЬКО ПРИМЕРАМИ РЕАЛИЗАЦИИ СЦЕНАРИЕВ АВТОМАТИЗАЦИИ! 
>
> Их можно и нужно дорабатывать под свои потребности. 

> [!NOTE]
> Все сценарии после импорта и первоначальной настройки необходимо **Скомпилировать** и **Активировать**.

## Содержание

- [Сценарий обработки Allure отчетов](#сценарий-обработки-allure-отчетов)
- [Сценарий создания Сигналов на основе данных из Allure-отчетов](#сценарий-создания-сигналов-на-основе-данных-из-allure-отчетов)
- [Сценарий привязки Порогов к Конфигурационным Единицам](#сценарий-привязки-порогов-к-конфигурационным-единицам)
- [Сценарий создания Сигналов на основе Порогов по метрикам](#сценарий-создания-сигналов-на-основе-порогов-по-метрикам)

## Сценарий обработки Allure отчетов

[**Autotest Builds Parser**](./Autotest%20Builds%20Parser.txt)

Тип сценария: `BuildProcessor`

Этот сценарий разбирает входящий zip-архив с отчетом Allure, анализирует содержимое, формирует метрики и отправляет результаты в маршрутный узел для формирования Сигналов.

Предварительная настройка не требуется.

## Сценарий создания Сигналов на основе данных из Allure-отчетов

[**Autotest Signal by Test Results**](./Autotest%20Signal%20by%20Test%20Results.txt)

Тип сценария: `SignalProcessor`

> [!IMPORTANT]  
> Примечание: Для работы требуется активированный **Сценарий обработки Allure отчетов**!

Этот сценарий обрабатывает данные о прохождении автоматических тестов, полученные из предыдущего сценария.

Перед компиляцией необходимо указать FQDN вашего инстанса в переменную MonqFQDN.

![image](./img/01.png|width=400px)

## Сценарий привязки Порогов к Конфигурационным Единицам

[**Autotest Signal Processor**](./Autotest%20Bind%20Metrics%20to%20CIs.txt)

Тип сценария: `ThresholdsProcessor`

⚠️ Примечание: Для работы требуется **Сценарий обработки Allure отчетов**!

Этот сценарий необходим, если в конфигурации проекта Автотестов включен сбор метрик. Сценарий `Autotest Builds Parser` помимо парсинга тестов также генерирует 3 метрики:
1. fm_autotest_steps_duration - длительность ШАГА
2. fm_autotest_testcases_duration - длительность ТЕСТ-КЕЙСА
3. fm_autotest_duration - длительность ВСЕГО автотеста

Для работы этого сценария требуется настроить Правила порогов на основе собранных метрик.

## Сценарий создания Сигналов на основе Порогов по метрикам Автотестов

[**Autotest Signal Processor**](./Autotest%20Bind%20Metrics%20to%20CIs.txt)

Тип сценария: `SignalProcessor`

⚠️ Примечание: Для работы требуется **всех вышеописанных сценариев**!

Этот сценарий обрабатывает установленные Пороги и, при превышении лимитов, создает Сигналы. Также реализована опция Skip_Signal_Create, которая позволяет не создавать новые Сигналы по метрикам, если уже есть Сигналы о провале тестов.
